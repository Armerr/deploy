import{r as e,c as r}from"./confirm.DugmkCAa.js";import{m as t,$ as o,G as s}from"./vendor.xaFdOCnE.js";import{s as n,T as a,A as i,U as u}from"./index.Dnl5OJ5X.js";const c={login:function(){e.push("/login")}};function p(p="",l="get",m={},d={},f={}){const{responseType:g,headers:h}=f,j=function(e={}){const t=o.create({responseEncoding:"utf8",timeout:a,withCredentials:!0});return t.interceptors.request.use((e=>{var r,t;const o=null!=(r=n.get(i))?r:"",s=null!=(t=n.get(u))?t:"";return o&&(e.headers.Authorization="Bearer ".concat(o)),s&&(e.params.userId=s),Promise.resolve(e)}),(e=>Promise.reject(e))),t.interceptors.response.use((e=>Promise.resolve(e)),(t=>{var s;if(o.isCancel(t))return Promise.reject(t);const n=null!=(s=t.response)?s:{};return 403===n.status?(r.pop("请重新登录","错误",{okText:"去登录"}).then((()=>{c.login()})),Promise.reject(t)):401===n.status?(r.pop("".concat(n.data.message),"错误"),Promise.reject(t)):(e.silent||r.pop("网络异常，请联系开发处理","错误"),Promise.reject(t))})),t}(f);return new Promise(((o,a)=>{j.request({url:"/api".concat(p),method:l,params:null!=m?m:{},data:f.useFormUrlEncoded?s.stringify(null!=d?d:{}):null!=d?d:{},headers:null!=h?h:{},responseType:null!=g?g:"json"}).then((s=>{if("arraybuffer"===g)return void o(s);const i=s.data;if(!i.status)return 401===i.errorCode?(n.clearStaff(),void r.pop("认证信息过期，请重新登录","错误",{popType:"error"}).then((()=>{e.replace("/login")}))):void(f.customError?a(i):(t.error(i.error),a()));o(i.data)}),(e=>{a(e)}))}))}function l(e,r={},t={},o={}){return p(e,"post",r,t,o)}const m={get:function(e,r={},t={}){return p(e,"get",r,{},t)},post:l,upload:function(e){return l("/yanxue/file/b/upload",{},e,{headers:{"Content-Type":"multipart/form-data"},silent:!0})}};export{m as h};
