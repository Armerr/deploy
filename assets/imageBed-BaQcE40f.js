import{_ as b,r as f,f as w,g as d,o as y,c as C,a as s,h as p,i as k,j as l,s as U,U as T,k as S,l as u,m as B,p as I,d as L}from"./index-CBEIk-od.js";import{C as N}from"./CloudUploadOutlined-C2i5eawC.js";const F={class:"main-container"},R={class:"upload-wrapper"},q={class:"ant-upload-drag-icon"},D={class:"tool-wrapper"},E={class:"autoCopy"},V={class:"compress"},j={__name:"imageBed",setup(z){const m=f([]),h=f([]),i=w({autoCopy:!0,compress:1}),g=t=>{const e=t.file.status;e==="done"?(navigator.clipboard.writeText(t.file.response).then(()=>{l.success("图片链接已复制")}).catch(o=>{l.error("复制失败: "+o.message)}),l.success(`${t.file.name} 上传成功`)):e==="error"&&l.error(`${t.file.name} 上传失败`)},_=t=>{const{file:e,onSuccess:o,onError:a}=t,c=new FormData;c.append("file",e);const r={userId:U.get(T),fileUid:e.uid};S(r,c).then(n=>{h.value.push({uid:n.fileUid,thumbUrl:n.url,url:n.url,name:n.fileName}),o(n.url),x()}).catch(n=>{a(n)})},v=({file:t})=>{const e=()=>{const o=h.value.find(a=>a.uid===t.uid);o&&o.url?navigator.clipboard.writeText(o.url).then(()=>{l.success("图片链接已复制")}).catch(a=>{l.error("复制失败: "+a.message)}):l.error("图片链接无效")};return u("div",{style:{position:"relative",display:"inline-block",width:"80px",height:"80px",border:"1px solid #d9d9d9",borderRadius:"4px",overflow:"hidden",textAlign:"center",cursor:"pointer",fontSize:"12px",lineHeight:"18px"},onClick:()=>e()},[u("img",{src:t.thumbUrl||t.url,alt:t.name,style:{width:"100%",height:"100%",objectFit:"cover"}}),u("span",{style:{position:"absolute",bottom:"0",left:"0",right:"0",padding:"0 5px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",fontSize:"10px"}},t.name)])},x=()=>{B(()=>{const t=document.querySelector(".ant-upload-list-picture-card");t&&t.scrollTo({left:0,behavior:"smooth"})})};return(t,e)=>{const o=d("a-upload-dragger"),a=d("a-switch"),c=d("a-input-number");return y(),C("div",F,[s("div",R,[p(o,{fileList:m.value,"onUpdate:fileList":e[0]||(e[0]=r=>m.value=r),name:"file",multiple:!0,"list-type":"picture-card","custom-request":_,onChange:g,"item-render":v,class:"custom-upload-dragger"},{default:k(()=>[s("p",q,[p(I(N))]),e[3]||(e[3]=s("p",{class:"ant-upload-text"},[L(" 拖拽文件到这里或者 "),s("span",{style:{color:"#3478f5"}},"点击上传")],-1)),e[4]||(e[4]=s("p",{class:"ant-upload-hint"},"支持多选或者单选，点击上传完成的图片后可复制到剪切板",-1))]),_:1},8,["fileList"])]),s("div",D,[s("span",E,[p(a,{checked:i.autoCopy,"onUpdate:checked":e[1]||(e[1]=r=>i.autoCopy=r),"inline-prompt":"","checked-children":"自动复制","un-checked-children":"自动复制"},null,8,["checked"])]),s("span",V,[e[5]||(e[5]=s("span",null,"压缩质量：",-1)),p(c,{max:1,min:0,step:.1,style:{width:"80px"},value:i.compress,"onUpdate:value":e[2]||(e[2]=r=>i.compress=r),placeholder:"0.0"},null,8,["value"])])])])}}},A=b(j,[["__scopeId","data-v-5117b6eb"]]);export{A as default};
